!function(o,e){"use strict";var n=e.module("ngWsmFavorites",["ng"]);n.factory("$ngWsmFavorites",function(o){function e(){var e={action:"check",elements:s};o({method:"POST",url:a,responseType:"json",data:e}).success(function(o,e,n,i){if(o.success){r="object"==typeof o.elements&&null!==o.elements?o.elements:[],console.log("fav_checked: ",r);for(var a in s){var f=s[a];"function"==typeof t[f]&&t[f](r.length>0&&r.indexOf(f)>-1)}c(o)}else console.warn(o)}).error(function(o,e,n,t){console.error("err =========================== (",o),s={}})}var n=this,t={},i=[],s=[],r=[],a="/bitrix/tools/wsm.favorites/action.php";n.onLoad=function(o){return"function"==typeof o&&void i.push(o)},n.onChange=function(o,e){return"function"==typeof e&&(s.push(o),t[o]=e,void(r.length>0&&r.indexOf(o)>-1&&t[o](!0)))};var c=function(o){for(var e in i)i[e](o)};return n.setFav=function(e,n){var i={action:"add",id:e};o({method:"POST",url:a,responseType:"json",data:i}).success(function(o,n,i,s){o.success?"function"==typeof t[e]&&t[e](o.checked):console.warn(o)}).error(function(o,e,n,t){console.error("err =========================== (",o),s={}})},n.reload=function(){e()},e(),n}),n.directive("wsmFavorite",["$ngWsmFavorites",function(o){return console.info("init directive ... favorite"),{scope:{favoriteId:"@",favoriteClass:"@"},link:function(e,n,t,i){return"string"!=typeof e.favoriteId||parseInt(typeof e.favoriteId)<1?void console.warn("not set favoriteId"):("undefined"!=typeof e.favoriteClass&&""!=e.favoriteClass||(e.favoriteClass="active"),o.onChange(e.favoriteId,function(o){console.log("onChange fav, selected = ",o,e.favoriteClass),o?n.addClass(e.favoriteClass):n.removeClass(e.favoriteClass)}),void n.bind("click",function(){o.setFav(e.favoriteId,!n.hasClass(e.favoriteClass))}))}}}]),n.directive("wsmFavoriteTotal",["$ngWsmFavorites",function(o){return console.info("init directive ... favorite total"),{scope:{},link:function(e,n,t,i){o.onLoad(function(o){console.log("onLoad fav, selected = ",o)})}}}])}(window,window.angular);
//# sourceMappingURL=wsm.favorites.min.js.map
